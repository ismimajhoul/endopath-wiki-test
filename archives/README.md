## ENDOPATH

# Description

Endopath is a project for the development of an AI asissted diagnosis tool from medical reports. The objective is to avoid invasive diagnosis and shorten the patient journey by using women's gynecological medical reports to diagnosis complex endometriosis.

Author readme file: Nicolai Wolpert (nicolai.wolpert@capgemini.com)  
Date: October 2024  
Contributors to code:  
Maxime Mock (maxime.mock@capgemini.com), from November 2023 - June 2023
Nicolai Wolpert, from June to October 2024


## Requirements
To be completed ...


# Installation

The required packages and their versions can be found in <pyproject.toml>.
Most packages were installed using Poetry, but many packages required installation by pip or manual installation from github (in those cases it is specified in the .toml file).

<br/>

# Usage
To be completed...

# Documentation
To be completed...

# Contributing
To be completed...

# License
To be completed...

# Contact
matteo.bovio@capgemini.com
mohamed-hamza.kermia@capgemini.com

# Acknowledgements
To be completed ...

# References
To be completed...


# Overview of data

There are several data versions but these are the most important ones, the ones that are used in the code:

| Name | Explication | Path |
| ---- | --- | --- |
| dossier-gyneco-23-03-2022.csv | Raw, unprocessed data with medical texts. | Raw |
| donnees_entree_nlp_sans_endo.csv | Data with medical texts, preprocessed and corrected, without the target columns referring to endometriosis. Used for NLP | Generate |
| Recueil (1).csv | Data with demographical informations and symptoms, '1' specifying presence, '0' absence of symptom. Used in endo-ML. | Raw |
| Recueil_final.csv | Like 'Receuil (1), but with tab that explains the meaning of the different columns. Not used in any script or notebook. | Raw |
| dictionnaire_correction.json | Dictionnary of misspelled words and their corrections for later use. Created in 'create_correct_dict_nlp' | Generate/Correction_mots |
| all_words.txt | All words that appear in the text | Generate/Correction_mots |
| data_gynéco_manual_extraction_raw.csv | This was generated by going through the gynéco files and noting all the informations manually. It is not the final file version used in the code because it contains some comments etc. | Generate |
| data_gynéco_manual_extraction.csv | Notes all the informations (present/absent) for the features as they have been found in the gynéco files by manual inspection. In difference to 'data_gynéco_manual_extraction_raw', the column names have the same format as in the recueil data here, and everything is cleanly formatted. Not finalized yet for all columns. | Generate |
| comparaison_gynéco_receuil.csv | In this file, for each feature, the present/absent values are noted for the original recueil data on the one hand and the infos extracted manually from the gyneco files on the other. This is to compare the two and resolve conflicting informations. Lines that are marked in red present cases where the two files seem to give conflicting information. | Generate |
| data_synth_priorité_gynéco.csv | Data synthesized between the gynéco and recueil data. In cases of conflicting information between the two, prioritizes the gynéco data. | Generate |
| data_synth_priorité_receuil.csv | Data synthesized between the gynéco and recueil data. In cases of conflicting information between the two, prioritizes the recueil data. | Generate |


<br/>

# Overview of code

There are several components/research paths to the project:

### Preprocessing

Preprocessing of data, e.g. orthographic correction of medical reports

### "Feature exploration": Highlight main symptoms of complex endometriosis

Use medical research data on main features involved in complex endometriosis for extract main symptoms in order to help practitioners to get a bettter understanding. Dimensionality reduction using stats, ML, PCA, ...

### "NLP": Translate medical reports into complex endometriosis’ symptoms

Transform medical reports (text data) thanks to Natural Language Processing into medical features.

### "endo-ML": Calculate a diagnosis’ scores

Using machine learning and complex endometriosis’ medical features to predict disease probability

<br/><br/>

# Overview of data

There are several data versions but these are the most important ones, the ones that are used in the code:

| Name | Explication | Path |
| ---- | --- | --- |
| dossier-gyneco-23-03-2022.csv | Raw, unprocessed data with medical texts. | Raw |
| donnees_entree_nlp_sans_endo.csv | Data with medical texts, preprocessed and corrected, without the target columns referring to endometriosis. Used for NLP | Generate |
| Recueil (1).csv | Data with demographical informations and symptoms, '1' specifying presence, '0' absence of symptom. Used in endo-ML. | Raw |
| Recueil_final.csv | Like 'Receuil (1), but with tab that explains the meaning of the different columns. Not used in any script or notebook. | Raw |
| dictionnaire_correction.json | Dictionnary of misspelled words and their corrections for later use. Created in 'create_correct_dict_nlp' | Generate/Correction_mots |
| all_words.txt | All words that appear in the text | Generate/Correction_mots |
| data_gynéco_manual_extraction_raw.csv | This was generated by going through the gynéco files and noting all the informations manually. It is not the final file version used in the code because it contains some comments etc. | Generate |
| data_gynéco_manual_extraction.csv | Notes all the informations (present/absent) for the features as they have been found in the gynéco files by manual inspection. In difference to 'data_gynéco_manual_extraction_raw', the column names have the same format as in the recueil data here, and everything is cleanly formatted. | Generate |
| comparaison_gynéco_receuil.csv | In this file, for each feature, the present/absent values are noted for the original recueil data on the one hand and the infos extracted manually from the gyneco files on the other. This is to compare the two and resolve conflicting informations. Lines that are marked in red present cases where the two files seem to give conflicting information. | Generate |
| data_synth_priorité_gynéco.csv | Data synthesized between the gynéco and recueil data. In cases of conflicting information between the two, prioritizes the gynéco data. | Generate |
| data_synth_priorité_receuil.csv | Data synthesized between the gynéco and recueil data. In cases of conflicting information between the two, prioritizes the recueil data. | Generate |


<br/><br/>

# Overview of code

| Name | Type | Research path(s) | Objective | Dependencies | Contributors | Output |
| ---- | --- | ---------------- | ------------- | --------- | ---------------- | ------- |
| extraction_endometriose | Script | Preprocessing | Script for creating a dataframe merging informations linked to endometriosis diagnostics | / | Maxime Mock | / |
| preprocess_dossier_gyneco | Script | Preprocessing | Helper functions for preprocessing of dosser-gyneco files | / | Maxime Mock | / |
| gestion_lexique | Script | Preprocessing | Helper functions for orthographic verification of words | / | Maxime Mock | / |
| ENDOPATHS_preprocess_DG | Script | Preprocessing | Script for preprocessing of the 'dossier-gyneco' file. Puts it into the form that is used for all analysis and classifications. | preprocess_dossier_gyneco, extraction_endometriose, gestion_lexique | Maxime Mock | donnees_entree_nlp_sans_endo.csv |
| create_correct_dict_nlp | Notebook | Preprocessing | Create dictionnary 'dict_correction' of misspelled words and their corrections for later use | / | Maxime Mock, Nicolai Wolpert | / |
| script_scrapping | Script | Preprocessing | Spelling correction thanks to google website requests| / | Maxime Mock, Nicolai Wolpert | / |
| scan_texts_dossier_gyneco | Script | Preprocessing | Script to scan the texts from the gyneco files for certain informations (like symptoms). This helped for the manual extraction of features. | / | Nicolai Wolpert | Helped to manually create 'data_gynéco_manual_extraction_raw.csv' |
| preprocess_NLP | Script | Preprocessing, NLP | Custom preprocessing functions for text data | dict_correction | Maxime Mock, Nicolai Wolpert | / |
| metrics_utils | Notebook | NLP, endo-ML | Custom functions for evaluating model performances | / | Maxime Mock, Nicolai Wolpert | / |
| Opti_utils.ML_utils | Script | NLP, endo-ML | Helper functions for Machine learning classification problems | / | Maxime Mock, Nicolai Wolpert | / |
| Opti_utils.custom_metrics | Script | NLP, endo-ML | Helper functions of custom metrics for Machine learning classification problems | / | Maxime Mock | / |
| Analyse_univariee | Notebook | Feature exploration | Exploratory data analysis, statistical tests of features linked to endometriosis | Opti_utils.ML_utils | Maxime Mock, Nicolai Wolpert | / |
| test_chi2 | Notebook | Feature exploration | Notebook to test for features most correlated with endometriosis | / | Maxime Mock | / |
| FAMD | Notebook | Feature exploration | Test of dimensionality reduction using Factor Analysis for Mixed Data | / | Maxime Mock | / |
| PCA_MCA | Notebook | Feature exploration | Test of dimensionality reduction using Principal Component Analysis and Multiple Correspondence Analysis | / | Maxime Mock | / |
| FAMD | Notebook | Feature exploration | Test of dimensionality reduction using Factor Analysis for Mixed Data | / | Maxime Mock | / |
| Analyse_univariee | Notebook | Feature exploration | Exploratory data analysis, statistical tests of features linked to endometriosis | Opti_utils.ML_utils | Maxime Mock, Nicolai Wolpert | / |
| NLP_ENDOPATHS_NER | Notebook | NLP, Feature exploration | Named entitiy recognition for identification of medical terms in the text | dict_correction, metrics_utils, preprocess_NLP, Opti_utils.ML_utils | Nicolai Wolpert | / |
| NLP_ENDOPATHS_ML | Notebook | NLP | Develop Machine Learning models for symptom prediction from text data | dict_correction, metrics_utils, preprocess_NLP, Opti_utils.ML_utils | Nicolai Wolpert | / |
| NLP_ENDOPATHS_LSTM | Notebook | NLP | Develop Long-term short-term models for symptom prediction from text data | dict_correction, metrics_utils, preprocess_NLP, Opti_utils.ML_utils | Nicolai Wolpert | / |
| NLP_ENDOPATHS_transformers | Notebook | NLP | Develop transformer models for symptom prediction from text data | dict_correction, metrics_utils, preprocess_NLP, Opti_utils.ML_utils | Nicolai Wolpert | / |
| NLP_ENDOPATHS_transformers | Notebook | NLP | Test openai models for symptom prediction from text data | dict_correction, metrics_utils, preprocess_NLP, Opti_utils.ML_utils | Nicolai Wolpert | / |
| ML_HGB | Notebook | endo-ML | Predict presence of endometriosis from symptoms using HistGradientBoosting classifiers | metrics_utils | Maxime Mock | / |
| ML_RF | Notebook | endo-ML | Predict presence of endometriosis from symptoms using Random Forest classifiers | metrics_utils | Maxime Mock | / |
| ML_XGB | Notebook | endo-ML | Predict presence of endometriosis from symptoms using XGBoost classifiers | metrics_utils | Maxime Mock | / |
| ENDOPATHS_Recueil_premiers_indicateurs | Notebook | endo-ML | Predict presence of endometriosis from symptoms using different classifiers and ML methods | metrics_utils | Maxime Mock | / |


<br/><br/>

# Notes

- The goal of the project is to predict the presence of deep endometriosis ("endométriose profonde"). The information whether endometriosis was diagnosed can be found in the last four 'anapath' columns in the 'receuil' data (anapath.lusd, anapath.lusg, anapath.torus and anapath.autre). Get only the deep endometriosis and ignore other types of endometriosis, the last column, 'anapath.autre' is ignored.
- The file 'dossier-gyneco-23-03-2022' can only be opened by password which should be located in a subfolder of the folder where the data are located.